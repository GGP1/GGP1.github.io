<!DOCTYPE html>
<html lang="en">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta http-equiv="Accept-CH" content="DPR, Viewport-Width, Width">
<link rel="icon" href=/favicon.ico type="image/gif">


<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload"
      as="style"
      href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
>
<link rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
      media="print" onload="this.media='all'" />
<noscript>
  <link
          href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
          rel="stylesheet">
</noscript>


<link rel="stylesheet" href="/css/font.css" media="all">



<meta property="og:url" content="http://localhost:1313/posts/rn_generic_list/">
  <meta property="og:site_name" content="Gastón Palomeque">
  <meta property="og:title" content="React Native generic list">
  <meta property="og:description" content="React Native List example">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2021-12-11T00:00:00+00:00">
    <meta property="article:modified_time" content="2021-12-11T00:00:00+00:00">
    <meta property="article:tag" content="React">
    <meta property="article:tag" content="Typescript">


  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="React Native generic list">
  <meta name="twitter:description" content="React Native List example">


<link rel="stylesheet" href="/bootstrap-5/css/bootstrap.min.css" media="all"><link rel="stylesheet" href="/css/header.css" media="all">
<link rel="stylesheet" href="/css/footer.css" media="all">


<link rel="stylesheet" href="/css/theme.css" media="all">

<style>
    :root {
        --text-color: #000;
        --text-secondary-color: #6c757d;
        --text-link-color: #4d7fb5;
        --background-color: #eaedf0;
        --secondary-background-color: #64ffda1a;
        --primary-color: #4d7fb5;
        --secondary-color: #f8f9fa;
		--btn-background-color: #9cc3ea8f;

         
        --text-color-dark: #e4e6eb;
        --text-secondary-color-dark: #b0b3b8;
        --text-link-color-dark: #ffffff;
        --background-color-dark: #18191a;
        --secondary-background-color-dark: #212529;
        --primary-color-dark: #ffffff;
        --secondary-color-dark: #212529;
		--btn-background-color-dark: #212529;
    }
    body {
        font-size: 1rem;
        font-weight: 400;
        line-height: 1.5;
        text-align: left;
    }

    html {
        background-color: var(--background-color) !important;
    }

    body::-webkit-scrollbar {
        height: 0px;
        width: 8px;
        background-color: var(--background-color);
    }

    ::-webkit-scrollbar-track {
        border-radius: 1rem;
    }

    ::-webkit-scrollbar-thumb {
        border-radius: 1rem;
        background: #b0b0b0;
        outline: 1px solid var(--background-color);
    }

    #search-content::-webkit-scrollbar {
        width: .5em;
        height: .1em;
        background-color: var(--background-color);
    }
</style>



<meta name="description" content="React Native List example">
<link rel="stylesheet" href="/css/single.css">


<script defer src="/fontawesome-6/all-6.4.2.js"></script>


  
  

  <title>
React Native generic list | Gastón Palomeque

  </title>
</head>

<body class="light">
  
  
<script>
    let localStorageValue = localStorage.getItem("pref-theme");
    let mediaQuery = window.matchMedia('(prefers-color-scheme: dark)').matches;

    switch (localStorageValue) {
        case "dark":
            document.body.classList.add('dark');
            break;
        case "light":
            document.body.classList.remove('dark');
            break;
        default:
            if (mediaQuery) {
                document.body.classList.add('dark');
            }
            break;
    }
</script>




<script>
    var prevScrollPos = window.pageYOffset;
    window.addEventListener("scroll", function showHeaderOnScroll() {
        let profileHeaderElem = document.getElementById("profileHeader");
        let currentScrollPos = window.pageYOffset;
        let resetHeaderStyle = false;
        let showNavBarOnScrollUp =  true ;
        let showNavBar = showNavBarOnScrollUp ? prevScrollPos > currentScrollPos : currentScrollPos > 0;
        if (showNavBar) {
            profileHeaderElem.classList.add("showHeaderOnTop");
        } else {
            resetHeaderStyle = true;
        }
        if(currentScrollPos === 0) {
            resetHeaderStyle = true;
        }
        if(resetHeaderStyle) {
            profileHeaderElem.classList.remove("showHeaderOnTop");
        }
        prevScrollPos = currentScrollPos;
    });
</script>



<header id="profileHeader">
    <nav class="pt-3 navbar navbar-expand-lg animate">
        <div class="container-fluid mx-xs-2 mx-sm-5 mx-md-5 mx-lg-5">
            
            <a class="navbar-brand primary-font text-wrap" href="/">
                
                <img src="/favicon.ico" width="30" height="30"
                    class="d-inline-block align-top">
                
                
            </a>

            
                <div>
                    <input id="search" autocomplete="off" class="form-control mr-sm-2 d-none d-md-block" placeholder='Search'
                        aria-label="Search" oninput="searchOnChange(event)">
                </div>
            

            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent"
                aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
                <svg aria-hidden="true" height="24" viewBox="0 0 16 16" version="1.1" width="24" data-view-component="true">
                    <path fill-rule="evenodd" d="M1 2.75A.75.75 0 011.75 2h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 2.75zm0 5A.75.75 0 011.75 7h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 7.75zM1.75 12a.75.75 0 100 1.5h12.5a.75.75 0 100-1.5H1.75z"></path>
                </svg>
            </button>

            
            <div class="collapse navbar-collapse text-wrap primary-font" id="navbarContent">
                <ul class="navbar-nav ms-auto text-center">
                    
                        <li class="nav-item navbar-text d-block d-md-none">
                            <div class="nav-link">
                                <input id="search" autocomplete="off" class="form-control mr-sm-2" placeholder='Search' aria-label="Search" oninput="searchOnChange(event)">
                            </div>
                        </li>
                    

                    
                    <li class="nav-item navbar-text">
                        <a class="nav-link" href="/#about" aria-label="about">
                            About
                        </a>
                    </li>
                    

                    
                    <li class="nav-item navbar-text">
                        <a class="nav-link" href="/#experience"
                            aria-label="experience">
                            Experience
                        </a>
                    </li>
                    

                    

                    
                    <li class="nav-item navbar-text">
                        <a class="nav-link" href="/#projects"
                            aria-label="projects">
                            Projects
                        </a>
                    </li>
                    

                    

                    

                    

                    
                    
                    
                    
                    <li class="nav-item navbar-text">
                        <a class="nav-link" href="/posts/" title="">
                            
                            Posts
                        </a>
                    </li>
                    
                    

                    
                    <li class="nav-item navbar-text">
                        
                        <div class="text-center">
                            <button id="theme-toggle">
                                <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                                </svg>
                                <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <circle cx="12" cy="12" r="5"></circle>
                                    <line x1="12" y1="1" x2="12" y2="3"></line>
                                    <line x1="12" y1="21" x2="12" y2="23"></line>
                                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                                    <line x1="1" y1="12" x2="3" y2="12"></line>
                                    <line x1="21" y1="12" x2="23" y2="12"></line>
                                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                                </svg>
                            </button>
                        </div>
                    </li>
                    

                </ul>

            </div>
        </div>
    </nav>
</header>
<div id="content">
<section id="single">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-sm-12 col-md-12 col-lg-9">
        <div class="pr-lg-4">
          <div class="title mb-5">
            <h1 class="text-center mb-4">React Native generic list</h1>
            <div class="text-center">
              
              Dec 11, 2021

              
            </div>
          </div>
          
          <div class="featured-image">
            <img class="img-fluid mx-auto d-block" src="/images/rn_list.png" alt="React Native generic list">
          </div>
          
          <article class="page-content  p-2">
          <p>React Native&rsquo;s <em>FlatList</em> is a component that supports many cool features while being simple and easy to use, it&rsquo;s a good example of a well-designed piece of software and that&rsquo;s why I decided to take it a step further.</p>
<p>For that, I&rsquo;ve developed a generic list built on top of it that handles <strong>pagination</strong> and <strong>refreshing</strong> internally, reducing a <em>lot</em> of repetitive code from my previous implementation.</p>
<p>I looked for something like this online but couldn&rsquo;t find anything similar, even though it might be useful for many people, so I decided to share it.</p>
<p>Here&rsquo;s the snippet with the entire code, let&rsquo;s take a brief look and review it in detail later:</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-tsx" data-lang="tsx"><span style="display:flex;"><span><span style="color:#c678dd">import</span> <span style="color:#e06c75">React</span>, { <span style="color:#e06c75">useCallback</span>, <span style="color:#e06c75">useEffect</span>, <span style="color:#e06c75">useState</span> } <span style="color:#c678dd">from</span> <span style="color:#98c379">&#34;react&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#c678dd">import</span> { <span style="color:#e06c75">FlatList</span>, <span style="color:#e06c75">FlatListProps</span> } <span style="color:#c678dd">from</span> <span style="color:#98c379">&#34;react-native&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">interface</span> <span style="color:#e06c75">ID</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">id</span>: <span style="color:#e5c07b">string</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">FLProps</span>&lt;<span style="color:#e06c75">T</span>&gt; <span style="color:#56b6c2">=</span> <span style="color:#e06c75">Omit</span><span style="color:#56b6c2">&lt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">FlatListProps</span>&lt;<span style="color:#e06c75">T</span>&gt;, 
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;data&#34;</span> <span style="color:#56b6c2">|</span> <span style="color:#98c379">&#34;keyExtractor&#34;</span> <span style="color:#56b6c2">|</span> <span style="color:#98c379">&#34;onEndReached&#34;</span> <span style="color:#56b6c2">|</span> <span style="color:#98c379">&#34;onRefresh&#34;</span> <span style="color:#56b6c2">|</span> <span style="color:#98c379">&#34;refreshing&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#56b6c2">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">interface</span> <span style="color:#e06c75">Props</span>&lt;<span style="color:#e06c75">T</span>&gt; <span style="color:#c678dd">extends</span> <span style="color:#e06c75">FLProps</span>&lt;<span style="color:#e06c75">T</span>&gt; {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">fetchItems</span><span style="color:#56b6c2">:</span> (<span style="color:#e06c75">cursor?</span>: <span style="color:#e5c07b">string</span>) <span style="color:#56b6c2">=&gt;</span> <span style="color:#e06c75">Promise</span><span style="color:#56b6c2">&lt;</span>[<span style="color:#e5c07b">string</span>, <span style="color:#e06c75">T</span>[]]<span style="color:#56b6c2">&gt;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">export</span> <span style="color:#c678dd">const</span> <span style="color:#e06c75">List</span> <span style="color:#56b6c2">=</span> &lt;<span style="color:#e06c75">T</span> <span style="color:#e06c75">extends</span> <span style="color:#e06c75">ID</span>&gt;(<span style="color:#e06c75">props</span>: <span style="color:#e5c07b">Props</span>&lt;<span style="color:#e06c75">T</span>&gt;) <span style="color:#56b6c2">=&gt;</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">const</span> [<span style="color:#e06c75">items</span>, <span style="color:#e06c75">setItems</span>] <span style="color:#56b6c2">=</span> <span style="color:#e06c75">useState</span>&lt;<span style="color:#e06c75">readonly</span> <span style="color:#e06c75">T</span>[]&gt;();
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">const</span> [<span style="color:#e06c75">cursor</span>, <span style="color:#e06c75">setCursor</span>] <span style="color:#56b6c2">=</span> <span style="color:#e06c75">useState</span>&lt;<span style="color:#e06c75">string</span>&gt;();
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">const</span> [<span style="color:#e06c75">refreshing</span>, <span style="color:#e06c75">setRefreshing</span>] <span style="color:#56b6c2">=</span> <span style="color:#e06c75">useState</span>&lt;<span style="color:#e06c75">boolean</span>&gt;(<span style="color:#e5c07b">false</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">const</span> <span style="color:#e06c75">getItems</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">useCallback</span>(<span style="color:#c678dd">async</span> () <span style="color:#56b6c2">=&gt;</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">try</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#c678dd">const</span> [<span style="color:#e06c75">nextCursor</span>, <span style="color:#e06c75">elems</span>] <span style="color:#56b6c2">=</span> <span style="color:#c678dd">await</span> <span style="color:#e06c75">props</span>.<span style="color:#e06c75">fetchItems</span>(<span style="color:#e06c75">cursor</span>);
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">setCursor</span>(<span style="color:#e06c75">nextCursor</span>);
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">items</span> <span style="color:#56b6c2">?</span> <span style="color:#e06c75">setItems</span>(<span style="color:#e06c75">items</span>.<span style="color:#e06c75">concat</span>(<span style="color:#e06c75">elems</span>)) <span style="color:#56b6c2">:</span> <span style="color:#e06c75">setItems</span>(<span style="color:#e06c75">elems</span>);
</span></span><span style="display:flex;"><span>		} <span style="color:#c678dd">catch</span> (<span style="color:#e06c75">err</span>) {
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">console</span>.<span style="color:#e06c75">log</span>(<span style="color:#e06c75">err</span>);
</span></span><span style="display:flex;"><span>		} <span style="color:#c678dd">finally</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">setRefreshing</span>(<span style="color:#e5c07b">false</span>);
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}, []);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">useEffect</span>(() <span style="color:#56b6c2">=&gt;</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">getItems</span>();
</span></span><span style="display:flex;"><span>	}, []);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">return</span> (
</span></span><span style="display:flex;"><span>		&lt;<span style="color:#e06c75">FlatList</span>
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">data</span><span style="color:#56b6c2">=</span>{<span style="color:#e06c75">items</span>}
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">keyExtractor</span><span style="color:#56b6c2">=</span>{<span style="color:#e06c75">item</span> <span style="color:#56b6c2">=&gt;</span> <span style="color:#e06c75">item</span>.<span style="color:#e06c75">id</span>}
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">onEndReached</span><span style="color:#56b6c2">=</span>{({ <span style="color:#e06c75">distanceFromEnd</span> }) <span style="color:#56b6c2">=&gt;</span> {
</span></span><span style="display:flex;"><span>				<span style="color:#e06c75">distanceFromEnd</span> <span style="color:#56b6c2">&lt;</span> <span style="color:#d19a66">0</span> <span style="color:#56b6c2">?</span> <span style="color:#e5c07b">undefined</span> <span style="color:#56b6c2">:</span> <span style="color:#e06c75">getItems</span>();
</span></span><span style="display:flex;"><span>			}}
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">onEndReachedThreshold</span><span style="color:#56b6c2">=</span>{
</span></span><span style="display:flex;"><span>				<span style="color:#e06c75">props</span>.<span style="color:#e06c75">onEndReachedThreshold</span> <span style="color:#56b6c2">?</span> <span style="color:#e06c75">props.onEndReachedThreshold</span> : <span style="color:#e5c07b">0.1</span>
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">refreshing</span><span style="color:#56b6c2">=</span>{<span style="color:#e06c75">refreshing</span>}
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">onRefresh</span><span style="color:#56b6c2">=</span>{() <span style="color:#56b6c2">=&gt;</span> {
</span></span><span style="display:flex;"><span>				<span style="color:#e06c75">setRefreshing</span>(<span style="color:#e5c07b">true</span>);
</span></span><span style="display:flex;"><span>				<span style="color:#e06c75">setCursor</span>(<span style="color:#e5c07b">undefined</span>);
</span></span><span style="display:flex;"><span>				<span style="color:#e06c75">setItems</span>(<span style="color:#e5c07b">undefined</span>);
</span></span><span style="display:flex;"><span>				<span style="color:#e06c75">getItems</span>();
</span></span><span style="display:flex;"><span>			}}
</span></span><span style="display:flex;"><span>			{<span style="color:#e06c75">...props</span>}
</span></span><span style="display:flex;"><span>		/&gt;
</span></span><span style="display:flex;"><span>	);
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h3 id="list-in-action"><code>List</code> in action</h3>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-tsx" data-lang="tsx"><span style="display:flex;"><span><span style="color:#c678dd">import</span> { <span style="color:#e06c75">List</span> } <span style="color:#c678dd">from</span> <span style="color:#98c379">&#34;./List&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">User</span> <span style="color:#56b6c2">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">id</span>: <span style="color:#e5c07b">string</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">username</span>: <span style="color:#e5c07b">string</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">export</span> <span style="color:#c678dd">const</span> <span style="color:#e06c75">UserList</span> <span style="color:#56b6c2">=</span> () <span style="color:#56b6c2">=&gt;</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">const</span> <span style="color:#e06c75">getUsers</span> <span style="color:#56b6c2">=</span> <span style="color:#c678dd">async</span> (<span style="color:#e06c75">cursor?</span>: <span style="color:#e5c07b">string</span>)<span style="color:#56b6c2">:</span> <span style="color:#e06c75">Promise</span><span style="color:#56b6c2">&lt;</span>[<span style="color:#e5c07b">string</span>, <span style="color:#e06c75">User</span>[]]<span style="color:#56b6c2">&gt;</span> <span style="color:#56b6c2">=&gt;</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">const</span> <span style="color:#e06c75">response</span> <span style="color:#56b6c2">=</span> <span style="color:#c678dd">await</span> <span style="color:#e06c75">fetch</span>(<span style="color:#98c379">`localhost:4000/users?cursor=</span><span style="color:#98c379">${</span><span style="color:#e06c75">cursor</span><span style="color:#98c379">}</span><span style="color:#98c379">`</span>);
</span></span><span style="display:flex;"><span>		<span style="color:#7f848e">// In this example, the response body contains a JSON object with 
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>		<span style="color:#7f848e">// the next cursor and an array of users
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>		<span style="color:#c678dd">const</span> <span style="color:#e06c75">json</span> <span style="color:#56b6c2">=</span> <span style="color:#c678dd">await</span> <span style="color:#e06c75">response</span>.<span style="color:#e06c75">json</span>() <span style="color:#c678dd">as</span> {<span style="color:#e06c75">next_cursor</span>: <span style="color:#e5c07b">string</span>, <span style="color:#e06c75">users</span>: <span style="color:#e5c07b">User</span>[]};
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">return</span> [<span style="color:#e06c75">json</span>.<span style="color:#e06c75">next_cursor</span>, <span style="color:#e06c75">json</span>.<span style="color:#e06c75">users</span>];
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">return</span> (
</span></span><span style="display:flex;"><span>		&lt;<span style="color:#e06c75">List</span>&lt;<span style="color:#e06c75">User</span>&gt;
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">fetchItems</span><span style="color:#56b6c2">=</span>{(<span style="color:#e06c75">cursor</span>) <span style="color:#56b6c2">=&gt;</span> <span style="color:#e06c75">getUsers</span>(<span style="color:#e06c75">cursor</span>)}
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">renderItem</span><span style="color:#56b6c2">=</span>{({ <span style="color:#e06c75">item</span> }) <span style="color:#56b6c2">=&gt;</span> &lt;<span style="color:#e06c75">View</span>&gt;&lt;<span style="color:#e06c75">Text</span>&gt;{<span style="color:#e06c75">item</span>.<span style="color:#e06c75">username</span>}&lt;/<span style="color:#e06c75">Text</span>&gt;&lt;/<span style="color:#e06c75">View</span>&gt;}
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">numColumns</span><span style="color:#56b6c2">=</span>{<span style="color:#d19a66">2</span>}
</span></span><span style="display:flex;"><span>			<span style="color:#7f848e">// More properties from FlatList may be included here
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>		/&gt;
</span></span><span style="display:flex;"><span>	);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>As you can see, it&rsquo;s extremely easy to use and requires few lines of code to have it working.</p>
<blockquote>
<p>Note two things, <code>&lt;User&gt;</code> makes explicit the type of items the list will contain and
<code>next_cursor</code> must always return a non-null value, if not, the request will return duplicated items.</p></blockquote>
<h2 id="component-breakdown">Component breakdown</h2>
<h3 id="properties">Properties</h3>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-tsx" data-lang="tsx"><span style="display:flex;"><span><span style="color:#c678dd">interface</span> <span style="color:#e06c75">ID</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">id</span>: <span style="color:#e5c07b">string</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">FLProps</span>&lt;<span style="color:#e06c75">T</span>&gt; <span style="color:#56b6c2">=</span> <span style="color:#e06c75">Omit</span><span style="color:#56b6c2">&lt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">FlatListProps</span>&lt;<span style="color:#e06c75">T</span>&gt;, 
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;data&#34;</span> <span style="color:#56b6c2">|</span> <span style="color:#98c379">&#34;keyExtractor&#34;</span> <span style="color:#56b6c2">|</span> <span style="color:#98c379">&#34;onEndReached&#34;</span> <span style="color:#56b6c2">|</span> <span style="color:#98c379">&#34;onRefresh&#34;</span> <span style="color:#56b6c2">|</span> <span style="color:#98c379">&#34;refreshing&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#56b6c2">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">interface</span> <span style="color:#e06c75">Props</span>&lt;<span style="color:#e06c75">T</span>&gt; <span style="color:#c678dd">extends</span> <span style="color:#e06c75">FLProps</span>&lt;<span style="color:#e06c75">T</span>&gt; {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">fetchItems</span><span style="color:#56b6c2">:</span> (<span style="color:#e06c75">cursor?</span>: <span style="color:#e5c07b">string</span>) <span style="color:#56b6c2">=&gt;</span> <span style="color:#e06c75">Promise</span><span style="color:#56b6c2">&lt;</span>[<span style="color:#e5c07b">string</span>, <span style="color:#e06c75">T</span>[]]<span style="color:#56b6c2">&gt;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">export</span> <span style="color:#c678dd">const</span> <span style="color:#e06c75">List</span> <span style="color:#56b6c2">=</span> &lt;<span style="color:#e06c75">T</span> <span style="color:#e06c75">extends</span> <span style="color:#e06c75">ID</span>&gt;(<span style="color:#e06c75">props</span>: <span style="color:#e5c07b">Props</span>&lt;<span style="color:#e06c75">T</span>&gt;) <span style="color:#56b6c2">=&gt;</span> {}
</span></span></code></pre></div><p>The <code>ID</code> interface is used for the generic to accept only items that has and id field in it, which is used to extract a unique key from each of them.</p>
<p><code>FLProps</code> contains all the properties of a <code>FlatList</code> except the ones that are specified with literal strings, preventing the caller from overwriting the properties that are automatically handled by the component.</p>
<blockquote>
<p>In my case I was always using the types&rsquo; id field to uniquely identify items inside the list but if it&rsquo;s not your case, <code>keyExtractor</code> can be delegated.</p></blockquote>
<p>Lastly, the component&rsquo;s properties are all of <code>FLProps</code> plus <code>fetchItems</code>, the callback from which the list will be populated.</p>
<h3 id="state">State</h3>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-tsx" data-lang="tsx"><span style="display:flex;"><span><span style="color:#c678dd">const</span> [<span style="color:#e06c75">items</span>, <span style="color:#e06c75">setItems</span>] <span style="color:#56b6c2">=</span> <span style="color:#e06c75">useState</span>&lt;<span style="color:#e06c75">readonly</span> <span style="color:#e06c75">T</span>[]&gt;();
</span></span><span style="display:flex;"><span><span style="color:#c678dd">const</span> [<span style="color:#e06c75">cursor</span>, <span style="color:#e06c75">setCursor</span>] <span style="color:#56b6c2">=</span> <span style="color:#e06c75">useState</span>&lt;<span style="color:#e06c75">string</span>&gt;();
</span></span><span style="display:flex;"><span><span style="color:#c678dd">const</span> [<span style="color:#e06c75">refreshing</span>, <span style="color:#e06c75">setRefreshing</span>] <span style="color:#56b6c2">=</span> <span style="color:#e06c75">useState</span>&lt;<span style="color:#e06c75">boolean</span>&gt;(<span style="color:#e5c07b">false</span>);
</span></span></code></pre></div><ul>
<li><code>items</code> holds the elements list, it&rsquo;s set to read-only as the items themselves won&rsquo;t be modified. Always try to type as much as possible.</li>
<li><code>cursor</code> contains the id of the element used to tell the server the starting point for a new list of elements.</li>
<li><code>refreshing</code> stores a boolean that tells whether the list is waiting for more values or not.</li>
</ul>
<h3 id="get-items-callback">Get items callback</h3>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-tsx" data-lang="tsx"><span style="display:flex;"><span><span style="color:#c678dd">const</span> <span style="color:#e06c75">getItems</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">useCallback</span>(<span style="color:#c678dd">async</span> () <span style="color:#56b6c2">=&gt;</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">try</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">const</span> [<span style="color:#e06c75">nextCursor</span>, <span style="color:#e06c75">elems</span>] <span style="color:#56b6c2">=</span> <span style="color:#c678dd">await</span> <span style="color:#e06c75">props</span>.<span style="color:#e06c75">fetchItems</span>(<span style="color:#e06c75">cursor</span>);
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">setCursor</span>(<span style="color:#e06c75">nextCursor</span>);
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">items</span> <span style="color:#56b6c2">?</span> <span style="color:#e06c75">setItems</span>(<span style="color:#e06c75">items</span>.<span style="color:#e06c75">concat</span>(<span style="color:#e06c75">elems</span>)) <span style="color:#56b6c2">:</span> <span style="color:#e06c75">setItems</span>(<span style="color:#e06c75">elems</span>);
</span></span><span style="display:flex;"><span>	} <span style="color:#c678dd">catch</span> (<span style="color:#e06c75">err</span>) {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">console</span>.<span style="color:#e06c75">log</span>(<span style="color:#e06c75">err</span>);
</span></span><span style="display:flex;"><span>	} <span style="color:#c678dd">finally</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">setRefreshing</span>(<span style="color:#e5c07b">false</span>);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}, []);
</span></span></code></pre></div><p>Here&rsquo;s where most of the list&rsquo;s work is done, we fetch items from a source - tipically an HTTP request to a server - using a cursor (initially undefined), so we will never get a duplicated item.</p>
<blockquote>
<p><code>useCallback</code> returns a memoized version of the callback that changes only when one of its dependencies has changed.</p>
<p>In this case it has none to execute the callback only when we explicity specify it and to prevent unnecessary renders from <code>useEffect</code>.</p></blockquote>
<p>The received cursor is stored for use in following calls and, if there are already stored items, the ones from the next request are appended to them.</p>
<p>Any potential error is catched and logged into the console.</p>
<p>Finally, <code>refreshing</code> is set to false to tell the list that we are done getting new values.</p>
<h3 id="use-effect-hook">Use effect hook</h3>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-tsx" data-lang="tsx"><span style="display:flex;"><span><span style="color:#e06c75">useEffect</span>(() <span style="color:#56b6c2">=&gt;</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">getItems</span>();
</span></span><span style="display:flex;"><span>}, []);
</span></span></code></pre></div><p><code>useEffect</code> runs once and gets the items that the list will contain when the component is mounted, the cursor will always be undefined.</p>
<h3 id="pagination">Pagination</h3>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-tsx" data-lang="tsx"><span style="display:flex;"><span>&lt;<span style="color:#e06c75">_</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">onEndReached</span><span style="color:#56b6c2">=</span>{({ <span style="color:#e06c75">distanceFromEnd</span> }) <span style="color:#56b6c2">=&gt;</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">distanceFromEnd</span> <span style="color:#56b6c2">&lt;</span> <span style="color:#d19a66">0</span> <span style="color:#56b6c2">?</span> <span style="color:#e5c07b">undefined</span> <span style="color:#56b6c2">:</span> <span style="color:#e06c75">getItems</span>();
</span></span><span style="display:flex;"><span>	}}
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">onEndReachedThreshold</span><span style="color:#56b6c2">=</span>{
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">props</span>.<span style="color:#e06c75">onEndReachedThreshold</span> <span style="color:#56b6c2">?</span> <span style="color:#e06c75">props.onEndReachedThreshold</span> : <span style="color:#e5c07b">0.1</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>/&gt;
</span></span></code></pre></div><p><code>onEndReached</code> is the callback that will be called whenever the user reaches the end of the list, in this case it will request more items to the server, using the cursor to specify the last item of the latest response.</p>
<p>There are some scenarios when the list is first rendered but it has so few items that it triggers the <code>onEndReached</code> callback, forcing another render.</p>
<p>In order to avoid this, <code>distanceFromEnd</code> (always negative on the first render) is set to undefined in those cases.</p>
<h3 id="refreshing">Refreshing</h3>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-tsx" data-lang="tsx"><span style="display:flex;"><span>&lt;<span style="color:#e06c75">_</span> 
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">refreshing</span><span style="color:#56b6c2">=</span>{<span style="color:#e06c75">refreshing</span>}
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">onRefresh</span><span style="color:#56b6c2">=</span>{() <span style="color:#56b6c2">=&gt;</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">setRefreshing</span>(<span style="color:#e5c07b">true</span>);
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">setCursor</span>(<span style="color:#e5c07b">undefined</span>);
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">setItems</span>(<span style="color:#e5c07b">undefined</span>);
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">getItems</span>();
</span></span><span style="display:flex;"><span>	}}
</span></span><span style="display:flex;"><span>/&gt;
</span></span></code></pre></div><p>Each time the list is pulled the <code>onRefresh</code> callback is triggered.</p>
<p>In it, the list is set to its refreshing state, the component&rsquo;s state is reset and new items are requested. It&rsquo;s like simulating the component&rsquo;s first render.</p>
<h3 id="potential-enhancements">Potential enhancements</h3>
<p>This is a simplified version of the List component I use so there are things that may be missing for your implementation.</p>
<p>One kind of obvious is the possibility that <code>fetchItems</code> returns undefined data.</p>
<p>Some others may be:</p>
<ul>
<li>Passing more parameters to the fetch items callback.</li>
<li>Set a limit to the amount of items that can be stored.</li>
<li>Use a reference to a boolean value to avoid requesting items on an unmounted list.</li>
</ul>
<p>Extending its utility it&rsquo;s up to your imagination and I hope this post has inspired you to create useful generic components.</p>

          </article>
        </div>
      </div>
      <div class="col-sm-12 col-md-12 col-lg-3">
        <div id="stickySideBar" class="sticky-sidebar">
          
          <aside class="toc">
              <h5>
                Table Of Contents
              </h5>
              <div class="toc-content">
                <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#list-in-action"><code>List</code> in action</a></li>
      </ul>
    </li>
    <li><a href="#component-breakdown">Component breakdown</a>
      <ul>
        <li><a href="#properties">Properties</a></li>
        <li><a href="#state">State</a></li>
        <li><a href="#get-items-callback">Get items callback</a></li>
        <li><a href="#use-effect-hook">Use effect hook</a></li>
        <li><a href="#pagination">Pagination</a></li>
        <li><a href="#refreshing">Refreshing</a></li>
        <li><a href="#potential-enhancements">Potential enhancements</a></li>
      </ul>
    </li>
  </ul>
</nav>
              </div>
          </aside>
          

          
          <aside class="tags">
            <h5>Tags</h5>
            <ul class="tags-ul list-unstyled list-inline">
              
              <li class="list-inline-item"><a href="http://localhost:1313/tags/react"
                target="_blank"
              >React</a></li>
              
              <li class="list-inline-item"><a href="http://localhost:1313/tags/typescript"
                target="_blank"
              >Typescript</a></li>
              
            </ul>
          </aside>
          

          
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12 col-lg-9 p-4">
        
      </div>
    </div>
  </div>
  <button class="p-2 px-3" onclick="topFunction()" id="topScroll">
    <i class="fas fa-angle-up"></i>
  </button>
</section>



<script>
  var topScroll = document.getElementById("topScroll");
  window.onscroll = function() {scrollFunction()};

  function scrollFunction() {
    if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
      topScroll.style.display = "block";
    } else {
      topScroll.style.display = "none";
    }
  }

  function topFunction() {
    document.body.scrollTop = 0;
    document.documentElement.scrollTop = 0;
  }

  
  let stickySideBarElem = document.getElementById("stickySideBar");
  let stickyNavBar =  true ;
  if(stickyNavBar) {
    let headerElem = document.getElementById("profileHeader");
    let headerHeight = headerElem.offsetHeight + 15;
    stickySideBarElem.style.top = headerHeight + "px";
  } else {
    stickySideBarElem.style.top = "50px";
  }
</script>




  </div><footer>
	

	

	<div class="text-center p-3">

	
	<span class="pr-1">
		<a href="https://github.com/GGP1" aria-label="github"><svg
				xmlns="http://www.w3.org/2000/svg" width="2.1em" height="2.1em" viewBox="0 0 1792 1792">
				<path id="footer-socialNetworks-github-svg-path"
					d="M522 1352q-8 9-20-3-13-11-4-19 8-9 20 3 12 11 4 19zm-42-61q9 12 0 19-8 6-17-7t0-18q9-7 17 6zm-61-60q-5 7-13 2-10-5-7-12 3-5 13-2 10 5 7 12zm31 34q-6 7-16-3-9-11-2-16 6-6 16 3 9 11 2 16zm129 112q-4 12-19 6-17-4-13-15t19-7q16 5 13 16zm63 5q0 11-16 11-17 2-17-11 0-11 16-11 17-2 17 11zm58-10q2 10-14 14t-18-8 14-15q16-2 18 9zm964-956v960q0 119-84.5 203.5t-203.5 84.5h-224q-16 0-24.5-1t-19.5-5-16-14.5-5-27.5v-239q0-97-52-142 57-6 102.5-18t94-39 81-66.5 53-105 20.5-150.5q0-121-79-206 37-91-8-204-28-9-81 11t-92 44l-38 24q-93-26-192-26t-192 26q-16-11-42.5-27t-83.5-38.5-86-13.5q-44 113-7 204-79 85-79 206 0 85 20.5 150t52.5 105 80.5 67 94 39 102.5 18q-40 36-49 103-21 10-45 15t-57 5-65.5-21.5-55.5-62.5q-19-32-48.5-52t-49.5-24l-20-3q-21 0-29 4.5t-5 11.5 9 14 13 12l7 5q22 10 43.5 38t31.5 51l10 23q13 38 44 61.5t67 30 69.5 7 55.5-3.5l23-4q0 38 .5 103t.5 68q0 22-11 33.5t-22 13-33 1.5h-224q-119 0-203.5-84.5t-84.5-203.5v-960q0-119 84.5-203.5t203.5-84.5h960q119 0 203.5 84.5t84.5 203.5z" />
			</svg>
		</a>
	</span>
	

	
	<span class="px-1">
		<a href="https://linkedin.com/gastonpalomeque" aria-label="linkedin">
			<svg xmlns="http://www.w3.org/2000/svg" width='1.8em' height='1.8em' fill="#fff" aria-label="LinkedIn"
				viewBox="0 0 512 512">
				<rect width="512" height="512" fill="#0077b5" rx="15%" />
				<circle cx="142" cy="138" r="37" />
				<path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198" />
				<path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32" />
			</svg>
		</a>
	</span>
	

	
	<a href="https://stackoverflow.com/users/12574067/ggp" aria-label="stackoverflow">
		<svg viewBox="-24 0 304 304" width="1.8em" height="1.8em" version="1.1" xmlns="http://www.w3.org/2000/svg"
			xmlns:xlink="http://www.w3.org/1999/xlink" preserveAspectRatio="xMidYMid" fill="#000000">
			<g id="SVGRepo_bgCarrier" stroke-width="0"></g>
			<g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
			<g id="SVGRepo_iconCarrier">
				<g>
					<polygon fill="#BCBBBB"
						points="216.329708 276.187929 216.329708 194.976776 243.28341 194.976776 243.28341 303.14163 0 303.14163 0 194.976776 26.9537015 194.976776 26.9537015 276.187929">
					</polygon>
					<path
						d="M56.7077876,187.275718 L189.025959,214.929516 L194.626728,188.325863 L62.3085568,160.672065 L56.7077876,187.275718 L56.7077876,187.275718 Z M74.2101912,124.267065 L196.727016,181.324901 L207.928555,156.821536 L85.4117295,99.4136524 L74.2101912,124.267065 Z M108.164854,64.0587971 L212.129132,150.520671 L229.281487,129.867835 L125.31721,43.4059609 L108.164854,64.0587971 L108.164854,64.0587971 Z M175.374084,0 L153.671104,16.1022113 L234.18216,124.617114 L255.88514,108.514902 L175.374084,0 Z M53.9074031,248.884179 L189.025959,248.884179 L189.025959,221.930478 L53.9074031,221.930478 L53.9074031,248.884179 Z"
						fill="#F48023"> </path>
				</g>
			</g>
		</svg>
	</a>
	

	

	<div class="pt-3">
		Gastón Palomeque
	</div>
</div>
</footer>
<script src="/bootstrap-5/js/bootstrap.bundle.min.js"></script>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl)
    })

</script>


    <script src="/js/search.js"></script>











  <section id="search-content" class="py-2">
    <div class="container" id="search-results"></div>
  </section>
</body>

</html>
